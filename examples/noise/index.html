<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Struct-Size Graph</title>
  <style>
    body { background: #222; color: #eee }
    svg { margin: 0; }
  </style>
  <link rel="stylesheet" href="./graph.css">
</head>

<body>

<div>
<button id="regen">regenerate</button>
</div>

<script type="module">

import { drawGraph } from "./graph.js";

// Simple seeded PRNG (Mulberry32)
const mulberry32 = seed => () => {
  let t = seed += 0x6D2B79F5;
  t = Math.imul(t ^ (t >>> 15), t | 1);
  t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
  return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
};

// Generate smooth noise using a seeded PRNG
const generateSmoothNoiseData = (nPoints, noiseLevel, seed) => {
  const rand = mulberry32(seed);
  const data = [];
  let y = 0;

  for (let i = 0; i < nPoints; i++) {
    data.push([i, y]);
    y += (rand() - 0.5) * noiseLevel;
  }

  return data;
};

let seed = 934.414183493471
const gen = () => generateSmoothNoiseData(1000, 2, seed += 10);
const graphConfig = () => ({
  data: [
    {label: "a", data: gen()},
    {label: "b", data: gen()},
    {label: "c", data: gen()},
    {label: "d", data: gen()}
  ]
});

let svg;
const run = () => {
  console.log(`Seed: ${seed}`);
  svg = drawGraph(graphConfig());
  document.body.insertBefore(svg, document.body.firstChild);
};
run();

const button = document.getElementById("regen");

button.onclick = () => {
  seed = Math.random() * 1000;
  svg.remove();
  run();
};

</script>

</body
</html>
